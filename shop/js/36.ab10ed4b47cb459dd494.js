webpackJsonp([36],{"+cZh":function(e,t,i){t=e.exports=i("FZ+f")(!1),t.push([e.i,"\n.qr_div[data-v-30730fba]{\n  text-align: center\n}\n.qr_img[data-v-30730fba]{\n  width: 200px;\n}\n\n",""])},B9yZ:function(e,t,i){"use strict";function s(e){i("crJi")}Object.defineProperty(t,"__esModule",{value:!0});var o=i("woOf"),a=i.n(o),r=(i("yt7g"),i("Av7u")),n=i.n(r),l=i("S49b"),d={data:function(){var e=function(e,t,i){""===t?i(new Error("请输入联系人手机号")):/^1(3|4|5|7|8)\d{9,10}$/.test(t)?i():i(new Error("请输入正确的联系人手机号"))};return{filters:{storeName:""},value:"",startTime:"",endTime:"",users:[],total:1,page:1,listLoading:!1,detFormVisible:!1,detLoading:!1,stateFormVisible:!1,stateLoading:!1,editFormVisible:!1,editLoading:!1,editFormRules:{storeName:[{required:!0,message:"请输入门店名称",trigger:"blur"},{max:20,message:"请输入正确的门店名称",trigger:"blur"}],address:[{required:!0,message:"请输入门店地址",trigger:"blur"},{max:60,message:"请输入正确的门店地址",trigger:"blur"}],telephone:[{required:!0,message:"请输入联系人手机号",trigger:"blur"},{validator:e,trigger:"blur"}]},detForm:{},stateForm:{},editForm:{storeName:"",address:"",telephone:"",shopHours:"",startTime:"",endTime:""},addFormVisible:!1,addLoading:!1,addFormRules:{storeName:[{required:!0,message:"请输入门店名称",trigger:"blur"},{max:20,message:"请输入正确的门店名称",trigger:"blur"}],address:[{required:!0,message:"请输入门店地址",trigger:"blur"},{max:60,message:"请输入正确的门店地址",trigger:"blur"}],telephone:[{required:!0,message:"请输入联系人手机号",trigger:"blur"},{validator:e,trigger:"blur"}]},addForm:{mname:"",storeName:"",address:"",telephone:"",shopHours:"",startTime:"",endTime:""},dialogVisibleBinding:!1,bindeFrom:{id:"",code:"",qrImg:""},codeText:"获取验证码",qrImages:!1,auth_time:null,disabledCode:!1}},methods:{submitCodeSuccess:function(){this.dialogVisibleBinding=!1,this.getList()},downloadQr:function(){window.location.href=this.bindeFrom.qrImg},submitCode:function(){var e=this,t={sid:this.bindeFrom.id.toString(),verCode:this.bindeFrom.code.toString()};Object(l.C)(t).then(function(t){200===t.data.status?(e.qrImages=!0,e.bindeFrom.qrImg=t.data.getCodeUrl):(e.bindeFrom.code="",e.qrImages=!1,e.bindeFrom.qrImg="")})},closeDialog:function(){this.codeText="获取验证码",this.auth_time=null,this.disabledCode=!1},getCode:function(){var e=this,t={sid:this.bindeFrom.id.toString()};Object(l.B)(t).then(function(t){if(200===t.status){e.disabledCode=!0,e.codeText="s后重新获取",e.auth_time=60;var i=setInterval(function(){--e.auth_time<=0&&(e.codeText="获取验证码",e.auth_time=null,e.disabledCode=!1,clearInterval(i))},1e3)}})},handleBinding:function(e,t){var i=this;this.bindeFrom={id:"",code:"",qrImg:""},this.qrImages=!1,t.sopenId?Object(l._48)({id:t.id}).then(function(e){200===e.status&&(i.$message({message:e.message,type:"success"}),i.getList())}):(this.dialogVisibleBinding=!0,this.bindeFrom.id=t.id)},test:function(e,t){var i=this;this.$confirm("此操作将修改门店状态, 确定修改?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,type:"warning"}).then(function(){var e={id:t.id,status:1==t.state?"Y":0==t.state?"N":"未知"};Object(l._82)(e).then(function(e){200==e.status?i.$message({type:"success",message:"修改成功!"}):i.$message({type:"success",message:"修改失败!"})})}).catch(function(){i.getUsers(),i.$message({type:"info",message:"取消修改"})})},handle:function(e,t){this.stateFormVisible=!0,this.stateForm=a()({},t),this.radio=this.stateForm.state},handleDet:function(e,t){var i=this;this.detFormVisible=!0,Object(l._40)({id:t.id}).then(function(e){i.detForm=a()({},e.data.store),i.detForm.wxNickName=e.data.wxNickName})},handleCurrentChange:function(e){this.page=e,this.getList()},getUsers:function(){this.page=1,this.getList()},getList:function(){var e=this,t={pageNum:this.page,storeName:this.filters.storeName};this.listLoading=!0,Object(l._42)(t).then(function(t){t.data,t.message;if(200==t.status){e.total=t.data.totalCount,e.users=t.data.storeList;for(var i,s=0;s<e.users.length;s++)i=e.users[s],"Y"==i.state?i.state=!0:i.state=!1}e.listLoading=!1})},handleReset:function(e,t){var i=this;this.$prompt("请输入新密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"密码格式不正确",inputValue:"123456"}).then(function(e){var s=e.value,o={password:n.a.MD5(s+t.saccount).toString(n.a.enc.Hex),sid:t.id};Object(l._81)(o).then(function(e){var t=i,s=e.status,o=e.message;200==s?i.$notify({title:"成功",message:o,type:"success"}):301==s||302==s?(sessionStorage.removeItem("user"),t.$router.push("/login"),i.$notify.error({title:"错误",message:o})):i.$notify.error({title:"错误",message:o})})}).catch(function(){i.$message({type:"info",message:"取消输入"})})},handleEdit:function(e,t){this.editFormVisible=!0,this.editForm=a()({},t);var i=t.shopHours.slice(0,5);this.startTime=i;var s=t.shopHours.slice(6,11);this.endTime=s},handleAdd:function(){console.log("123"),this.addFormVisible=!0},editSubmit:function(){var e=this;this.$refs.editForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){e.editLoading=!0;var t={id:e.editForm.id,storeName:e.editForm.storeName,address:e.editForm.address,telephone:e.editForm.telephone,shopHours:e.startTime+"-"+e.endTime};Object(l._80)(t).then(function(t){e.editLoading=!1;var i=t.status,s=t.message;200==i?e.$notify({title:"成功",message:s,type:"success"}):e.$notify.error({title:"错误",message:s}),e.$refs.editForm.resetFields(),e.editFormVisible=!1,e.getUsers()})})})},addSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){e.addLoading=!0;var t={storeName:e.addForm.storeName,address:e.addForm.address,telephone:e.addForm.telephone,shopHours:e.addForm.startTime+"-"+e.addForm.endTime};Object(l.g)(t).then(function(t){e.addLoading=!1,e.$notify({title:"成功",message:"提交成功",type:"success"}),e.$refs.addForm.resetFields(),e.addFormVisible=!1,e.getUsers()})})})}},mounted:function(){this.getUsers()}},m=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",[i("el-row",[i("el-form",{ref:"filters",attrs:{inline:!0,model:e.filters}},[i("el-form-item",{attrs:{label:"门店名称"}},[i("el-input",{staticClass:"fixed_search_input",attrs:{placeholder:"门店名称"},model:{value:e.filters.storeName,callback:function(t){e.$set(e.filters,"storeName",t)},expression:"filters.storeName"}})],1),e._v(" "),i("el-form-item",{staticStyle:{float:"right"}},[i("el-button",{attrs:{type:"primary",round:""},on:{click:e.getUsers}},[e._v("查询")])],1)],1)],1),e._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}]},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users,border:"","highlight-current-row":""}},[i("el-table-column",{attrs:{prop:"storeName",label:"门店名称","min-width":"120"}}),e._v(" "),i("el-table-column",{attrs:{prop:"address",label:"门店地址","min-width":"180"}}),e._v(" "),i("el-table-column",{attrs:{prop:"telephone",label:"联系电话","min-width":"120"}}),e._v(" "),i("el-table-column",{attrs:{prop:"saccount",label:"登录帐号","min-width":"120"}}),e._v(" "),i("el-table-column",{attrs:{label:"门店状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-switch",{attrs:{name:"value"},on:{change:function(i){e.test(t.$index,t.row)}},model:{value:t.row.state,callback:function(i){e.$set(t.row,"state",i)},expression:"scope.row.state"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){e.handleReset(t.$index,t.row)}}},[e._v("密码重置")]),e._v(" "),i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(i){e.handleBinding(t.$index,t.row)}}},[e._v(e._s(t.row.sopenId?"解绑":"绑定"))]),e._v(" "),i("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(i){e.handleDet(t.$index,t.row)}}},[e._v("详情")])]}}])})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"请填写绑定信息",visible:e.dialogVisibleBinding,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisibleBinding=t},close:e.closeDialog}},[i("el-form",{ref:"bindeFrom",attrs:{inline:!0,model:e.bindeFrom,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"验证码"}},[i("el-input",{model:{value:e.bindeFrom.code,callback:function(t){e.$set(e.bindeFrom,"code",t)},expression:"bindeFrom.code"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{plain:"",disabled:e.disabledCode},on:{click:e.getCode}},[e._v(e._s(e.auth_time)+e._s(e.codeText))])],1)],1),e._v(" "),e.qrImages?i("div",{staticClass:"qr_div"},[i("div",[i("img",{staticClass:"qr_img",attrs:{src:e.bindeFrom.qrImg,alt:"二维码"}})]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:e.downloadQr}},[e._v("下载二维码")])],1):e._e(),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisibleBinding=!1}}},[e._v("取 消")]),e._v(" "),e.qrImages?i("el-button",{attrs:{type:"primary"},on:{click:e.submitCodeSuccess}},[e._v("我已授权")]):i("el-button",{attrs:{type:"primary"},on:{click:e.submitCode}},[e._v("确 定")])],1)],1),e._v(" "),i("el-row",[i("el-pagination",{staticStyle:{"text-align":"center",background:"#fff",padding:"15px"},attrs:{layout:"prev, pager, next","current-page":e.page,"page-size":20,total:e.total,background:""},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{attrs:{title:"门店详情",visible:e.detFormVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.detFormVisible=t}}},[i("el-form",{ref:"detForm",attrs:{model:e.detForm,"label-width":"120px","label-position":"left"}},[i("el-form-item",{attrs:{label:"门店名称："}},[i("span",[e._v(e._s(e.detForm.storeName))])]),e._v(" "),i("el-form-item",{attrs:{label:"管理员："}},[i("span",[e._v(e._s(e.detForm.wxNickName||"暂无"))])]),e._v(" "),i("el-form-item",{attrs:{label:"电话："}},[i("span",[e._v(e._s(e.detForm.telephone))])]),e._v(" "),i("el-form-item",{attrs:{label:"详细地址："}},[i("span",[e._v(e._s(e.detForm.address))])]),e._v(" "),i("el-form-item",{attrs:{label:"门店编号："}},[i("span",[e._v(e._s(e.detForm.storeName))])]),e._v(" "),i("el-form-item",{attrs:{label:"营业时间："}},[i("span",[e._v(e._s(e.detForm.shopHours))])])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"修改信息",visible:e.editFormVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.editFormVisible=t}}},[i("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editFormRules}},[i("el-form-item",{attrs:{label:"门店名称",prop:"storeName"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.storeName,callback:function(t){e.$set(e.editForm,"storeName",t)},expression:"editForm.storeName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"门店地址",prop:"address"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.address,callback:function(t){e.$set(e.editForm,"address",t)},expression:"editForm.address"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"联系电话",prop:"telephone"}},[i("el-input",{model:{value:e.editForm.telephone,callback:function(t){e.$set(e.editForm,"telephone",t)},expression:"editForm.telephone"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"营业时间",prop:"shopHours"}},[[i("el-time-select",{attrs:{placeholder:"起始时间","picker-options":{start:"08:30",step:"00:15",end:"18:30"}},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}})]],2),e._v(" "),i("el-form-item",{staticStyle:{"margin-left":"68px"},attrs:{label:"",prop:"shopHours"}},[[i("el-time-select",{attrs:{placeholder:"结束时间","picker-options":{start:"00:00",step:"00:15",end:"24:00"}},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}})]],2)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary",loading:e.editLoading},nativeOn:{click:function(t){return e.editSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"新增门店",visible:e.addFormVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.addFormVisible=t}}},[i("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addFormRules}},[i("el-form-item",{attrs:{label:"门店名称",prop:"storeName"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.storeName,callback:function(t){e.$set(e.addForm,"storeName",t)},expression:"addForm.storeName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.address,callback:function(t){e.$set(e.addForm,"address",t)},expression:"addForm.address"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"电话",prop:"telephone"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.telephone,callback:function(t){e.$set(e.addForm,"telephone",t)},expression:"addForm.telephone"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"营业时间"}},[[i("el-time-select",{attrs:{placeholder:"起始时间","picker-options":{start:"00:00",step:"00:15",end:"24:00"}},model:{value:e.addForm.startTime,callback:function(t){e.$set(e.addForm,"startTime",t)},expression:"addForm.startTime"}})]],2),e._v(" "),i("el-form-item",{staticStyle:{"margin-left":"68px"},attrs:{label:""}},[[i("el-time-select",{attrs:{placeholder:"结束时间","picker-options":{start:"00:00",step:"00:15",end:"24:00",minTime:e.addForm.startTime}},model:{value:e.addForm.endTime,callback:function(t){e.$set(e.addForm,"endTime",t)},expression:"addForm.endTime"}})]],2)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1)],1)},c=[],u={render:m,staticRenderFns:c},p=u,f=i("VU/8"),g=s,b=f(d,p,!1,g,"data-v-30730fba",null);t.default=b.exports},crJi:function(e,t,i){var s=i("+cZh");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i("rjj0")("0d956cb2",s,!0,{})}});